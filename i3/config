################
#   Startup    #
################

exec --no-startup-id /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 &
exec --no-startup-id "${HOME}/.config/screenlayout.sh"
exec --no-startup-id nitrogen --restore
exec --no-startup-id xfce4-clipman &
exec --no-startup-id redshift-gtk &
exec --no-startup-id unclutter --timeout 2 &

################
#  Behaviour   #
################

# Disable cursor warping to different monitors
mouse_warping none

# Workspace_auto_back_and_forth yes
workspace_layout tabbed

################
#    Theme     #
################
set $Background #16161C
set $Foreground #BBBBBB
set $Black      #06060C
set $Dark       #232530
set $Gray       #4C4D53
set $White      #D5D8DA
set $Tacao      #FAC29A
set $Rosebud    #FAB795
set $Apricot    #F09483
set $Cranberry  #E95678
set $Lavender   #B877DB
set $Turquoise  #25B0BC

font pango:Fira Code Medium 11

title_align center
smart_borders on
default_border pixel 1
for_window [class=".*" floating] border normal 1

# class                 border      background  text       indicator   child_border
client.focused          $Background $Background $Cranberry $Dark       $Gray
client.focused_inactive $Background $Background $Lavender  $Background $Dark
client.unfocused        $Background $Background $Gray      $Background $Dark
client.urgent           $Background $Background $Apricot   $Background $Apricot
client.placeholder      $Background $Background $Gray      $Background $Dark
client.background       $Background

# Always floating
for_window [class="Deadbeef"]   floating enable, resize set 1000px 800px, move workspace current
for_window [class="Galculator"] floating enable, move workspace current

# Steam
for_window [class="^Steam$" title="^Friends List$"]         floating enable
for_window [class="^Steam$" title="Steam - News"]           floating enable
for_window [class="^Steam$" title=".* - Chat"]              floating enable
for_window [class="^Steam$" title="^Settings$"]             floating enable
for_window [class="^Steam$" title=".* - event started"]     floating enable
for_window [class="^Steam$" title=".* CD key"]              floating enable
for_window [class="^Steam$" title="^Steam - Self Updater$"] floating enable
for_window [class="^Steam$" title="^Screenshot Uploader$"]  floating enable
for_window [class="^Steam$" title="^Steam Guard - Computer Authorization Required$"] floating enable


#################
#  Status bar   #
#################
bar {
  colors {
    statusline         $Foreground
    background         $Background
    focused_workspace  $Background $Background $Cranberry
    active_workspace   $Background $Background $Lavender
    inactive_workspace $Background $Background $Gray
    urgent_workspace   $Background $Background $Apricot
    binding_mode       $Cranberry  $Cranberry  $Background
    separator          $Foreground
  }
  workspace_min_width 25
  position top
  separator_symbol " "
  status_command i3status
}

#################
#  Keybindings  #
#################

#
# Use `xev` to get keysyms
#

# Setup basic modifiers
set $Mod  Mod4
set $Alt  Mod1

# Use Mouse+$Mod to drag floating windows to their wanted position
floating_modifier $Mod

# Helper variables and commands
set $SizeUnit 40 px
set $RefreshBar killall -SIGUSR1 i3status
set $Terminal alacritty -e
set $DmenuConfig -i -fn 'Fira Code Medium' -nb '#16161C' -nf '#E95678' -sb '#E95678' -sf '#16161C'
set $Logout "i3-nagbar -f 'pango:Fira Code' -t warning -m 'Would you like to logout?' -B 'Yes' 'i3-msg exit'"

bindsym $Mod+f fullscreen toggle
bindsym $Mod+Shift+s workspace back_and_forth

bindsym $Mod+t layout tabbed
bindsym $Mod+s layout toggle split, border pixel 1

bindsym $Mod+Shift+space floating toggle
bindsym $Mod+space focus mode_toggle

bindsym $Mod+a focus parent
bindsym $Mod+d focus child

bindsym --release $Mod+q  kill
bindsym --release $Mod+c  kill
bindsym --release button2 kill

bindsym $Mod+Shift+c reload
bindsym $Mod+Shift+r restart

bindsym $Mod+grave       scratchpad show
bindsym $Mod+Shift+grave move scratchpad

# Make screenshot of region and copy to clipboard
bindsym Print exec "xfce4-screenshooter -rc"
# Make screenshot of focused window
bindsym $Mod+Print exec "xfce4-screenshooter -wc"

# Media controls
bindsym XF86AudioRaiseVolume       exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@     +10% && $RefreshBar
bindsym XF86AudioLowerVolume       exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@     -10% && $RefreshBar
bindsym XF86AudioMute              exec --no-startup-id pactl set-sink-mute   @DEFAULT_SINK@   toggle && $RefreshBar
bindsym XF86AudioMicMute           exec --no-startup-id pactl set-source-mute @DEFAULT_SOURCE@ toggle && $RefreshBar
bindsym XF86Tools                  exec --no-startup-id deadbeef
bindsym XF86Calculator             exec --no-startup-id galculator
bindsym XF86HomePage               exec --no-startup-id brave
bindsym XF86Explorer               exec --no-startup-id pcmanfm

# System actions
bindsym $Mod+Shift+q               exec $Logout
bindsym $Mod+Scroll_Lock           exec xset r rate 200 50
bindsym $Mod+Shift+colon           exec --no-startup-id i3lock -fec 000000
bindsym --release $Mod+Pause       exec systemctl suspend
bindsym --release $Mod+Shift+Pause exec poweroff
bindsym --release $Mod+F12         exec ~/scripts/hide-desktop

# Launchers
bindsym $Mod+p                     exec --no-startup-id i3-dmenu-desktop --dmenu="dmenu $DmenuConfig"
bindsym $Mod+Shift+p               exec --no-startup-id dmenu_run $DmenuConfig

# Other programs
bindsym $Mod+Return                exec --no-startup-id alacritty
bindsym $Mod+b                     exec --no-startup-id brave
bindsym $Mod+Shift+b               exec --no-startup-id brave --incognito
bindsym $Mod+e                     exec --no-startup-id pcmanfm
bindsym $Mod+g                     exec --no-startup-id gimp
bindsym $Mod+n                     exec --no-startup-id code -r ~/notes.md
bindsym $Mod+m                     exec --no-startup-id code -r ~/pg/schedule.md
bindsym $Mod+i                     exec --no-startup-id code ~/.config
bindsym $Mod+Shift+n               exec --no-startup-id $Terminal nvim
bindsym $Mod+Shift+e               exec --no-startup-id $Terminal ranger
bindsym $Mod+Shift+x               exec --no-startup-id $Terminal ~/scripts/xpad
bindsym Control+$Alt+Delete        exec --no-startup-id $Terminal htop

bindsym $Mod+1 workspace number 1
bindsym $Mod+2 workspace number 2
bindsym $Mod+3 workspace number 3
bindsym $Mod+4 workspace number 4
bindsym $Mod+5 workspace number 5
bindsym $Mod+6 workspace number 6
bindsym $Mod+7 workspace number 7
bindsym $Mod+8 workspace number 8
bindsym $Mod+9 workspace number 9

bindsym $Mod+Prior workspace next_on_output
bindsym $Mod+Next  workspace prev_on_output

bindsym $Mod+Shift+1 move container to workspace number 1
bindsym $Mod+Shift+2 move container to workspace number 2
bindsym $Mod+Shift+3 move container to workspace number 3
bindsym $Mod+Shift+4 move container to workspace number 4
bindsym $Mod+Shift+5 move container to workspace number 5
bindsym $Mod+Shift+6 move container to workspace number 6
bindsym $Mod+Shift+7 move container to workspace number 7
bindsym $Mod+Shift+8 move container to workspace number 8
bindsym $Mod+Shift+9 move container to workspace number 9

bindsym $Mod+Shift+comma  move workspace to output right
bindsym $Mod+Shift+period move workspace to output left
bindsym $Mod+Shift+slash  exec ~/scripts/swap-workspaces

bindsym $Mod+Shift+Prior move container to workspace next_on_output
bindsym $Mod+Shift+Next  move container to workspace prev_on_output

bindsym $Mod+h     focus left
bindsym $Mod+j     focus down
bindsym $Mod+k     focus up
bindsym $Mod+l     focus right

bindsym $Mod+Left  focus left
bindsym $Mod+Down  focus down
bindsym $Mod+Up    focus up
bindsym $Mod+Right focus right

bindsym $Mod+Shift+h     move left  $SizeUnit
bindsym $Mod+Shift+j     move down  $SizeUnit
bindsym $Mod+Shift+k     move up    $SizeUnit
bindsym $Mod+Shift+l     move right $SizeUnit

bindsym $Mod+Shift+Left  move left  $SizeUnit
bindsym $Mod+Shift+Down  move down  $SizeUnit
bindsym $Mod+Shift+Up    move up    $SizeUnit
bindsym $Mod+Shift+Right move right $SizeUnit

bindsym $Mod+Ctrl+Shift+h     move container to output left
bindsym $Mod+Ctrl+Shift+j     move container to output down
bindsym $Mod+Ctrl+Shift+k     move container to output up
bindsym $Mod+Ctrl+Shift+l     move container to output right

bindsym $Mod+Ctrl+Shift+Left  move container to output left
bindsym $Mod+Ctrl+Shift+Down  move container to output down
bindsym $Mod+Ctrl+Shift+Up    move container to output up
bindsym $Mod+Ctrl+Shift+Right move container to output right

bindsym $Mod+Ctrl+h     resize shrink width  $SizeUnit
bindsym $Mod+Ctrl+j     resize grow   height $SizeUnit
bindsym $Mod+Ctrl+k     resize shrink height $SizeUnit
bindsym $Mod+Ctrl+l     resize grow   width  $SizeUnit

bindsym $Mod+Ctrl+Left  resize shrink width  $SizeUnit
bindsym $Mod+Ctrl+Down  resize grow   height $SizeUnit
bindsym $Mod+Ctrl+Up    resize shrink height $SizeUnit
bindsym $Mod+Ctrl+Right resize grow   width  $SizeUnit

################
#    Modes     #
################

mode "emoji" {
  bindsym --release 1 exec "xdotool type 'üíØ'"
  bindsym --release 3 exec "xdotool type '‚ù§Ô∏è'"
  bindsym --release w exec "xdotool type 'üò©'"
  bindsym --release e exec "xdotool type 'üëÄ'"
  bindsym --release r exec "xdotool type 'üòå'"
  bindsym --release t exec "xdotool type 'ü§î'"
  bindsym --release y exec "xdotool type 'üëç'"
  bindsym --release o exec "xdotool type 'üëå'"
  bindsym --release i exec "xdotool type 'ü§å'"
  bindsym --release p exec "xdotool type 'üí©'"
  bindsym --release a exec "xdotool type 'üò≥'"
  bindsym --release s exec "xdotool type 'üòè'"
  bindsym --release d exec "xdotool type 'üòÉ'"
  bindsym --release f exec "xdotool type 'üî•'"
  bindsym --release g exec "xdotool type 'üåµ'"
  bindsym --release z exec "xdotool type 'üíÅ'"
  bindsym --release x exec "xdotool type 'üôÜ'"
  bindsym --release c exec "xdotool type 'ü§∑'"

  set $ExitCmd mode "default"
  bindsym Return      $ExitCmd
  bindsym Escape      $ExitCmd
  bindsym $Mod+period $ExitCmd
}

bindsym $Mod+period mode "emoji"

mode "swap" {
  bindsym h     focus left
  bindsym j     focus down
  bindsym k     focus up
  bindsym l     focus right

  bindsym Left  focus left
  bindsym Down  focus down
  bindsym Up    focus up
  bindsym Right focus right

  set $ExitCmd swap container with mark "swap", unmark "swap", mode "default"
  bindsym Return     $ExitCmd
  bindsym Escape     $ExitCmd
  bindsym $Mod+slash $ExitCmd
}

bindsym $Mod+slash mark --add "swap", mode "swap"
